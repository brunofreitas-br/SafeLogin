# SafeLogin

## Overview

**SafeLogin** is a solution designed to protect users from advanced phishing attacks, such as those carried out using Man-in-the-Middle (MitM) techniques with tools like Evilginx2. The solution integrates with Microsoft Entra ID (formerly Azure AD) and uses Azure Functions to validate login URLs in real-time, alerting users to potential phishing attempts.

## Features

- **Login URL Validation**: SafeLogin checks whether the login URL accessed by the user is legitimate by comparing it against a list of authorized URLs.
- **Visual Notification**: When a phishing attempt is detected, the solution displays an alert banner on the custom Entra ID login page, warning the user of the threat.
- **Logging and Monitoring**: The solution logs detected phishing attempts, enabling continuous monitoring and incident response.
- **Azure Integration**: Utilizes Azure Functions and Blob Storage for a scalable and easy-to-manage solution.

- ![image](https://github.com/user-attachments/assets/6e99b52d-563a-4d85-addd-57ddf8bae8e0)


## Solution Architecture

The solution architecture consists of the following components:

1. **Azure Function**: Validates login URLs in real-time and returns conditional responses to the front-end.
2. **Custom Entra ID Login Page**: Displays phishing alerts to users when a malicious URL is detected.
3. **Azure Blob Storage**: Stores and serves phishing alert images.

## How to Set Up

### Prerequisites

- **Azure Subscription**: An Azure account to set up the Azure Function and Blob Storage.
- **Microsoft Entra ID (Azure AD)**: Access to your Entra ID instance to customize the login page.

### Setup Steps

1. **Clone the Repository**
   ```bash
   git clone [https://github.com/brunofreitas-br/SafeLogin.git]
   cd your-repository
   ```

2. **Set Up the Azure Function**

   - The Azure Function should be created using Visual Studio Code to allow for easy manipulation of the `requirements.txt` file.
   - After setting up the function, make sure to add the following dependency to the `requirements.txt` file:
     ```plaintext
     requests
     ```
   - This ensures that the necessary libraries are installed for the function to run correctly.
   - Copy the Python code from `SafeLogin-EntraID.py` in this repository and paste it into the `function_app.py` file that is generated when the Function is created in Visual Studio Code.
   - Update the script with the URL of your phishing alert image.

3. **Customize the Entra ID Login Page**
   - Upload the custom CSS file to your Entra ID instance.
   - Before uploading the CSS file, make sure to update it with the URL of the Azure Function generated during setup.
   - The login page will automatically update to integrate the SafeLogin solution.

4. **Testing and Monitoring**
   - Test the functionality by configuring a malicious login URL and verifying that the solution correctly displays the phishing alert.
   - Monitor detected phishing attempts through logs generated by the Azure Function.

## Contributing

If you would like to contribute to SafeLogin, feel free to fork the repository, create a branch, add your modifications, and submit a pull request.
